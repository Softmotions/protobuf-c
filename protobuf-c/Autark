set {
  root {
    LIBPROTOBUF_C_A
  }
  CC { libprotobuf-c.a }
}

set {
  SOURCES
  protobuf-c.c
}

cc {
  ${SOURCES}
  ${CFLAGS}
  ${CC}
  consumes {
    C{config.h}
  }
}

run {
  exec { ${AR} rcs ${LIBPROTOBUF_C_A} ${CC_OBJS} }
  consumes {
    ${CC_OBJS}
  }
  produces {
    ${LIBPROTOBUF_C_A}
  }
}

configure {
  libprotobuf-c.pc.in
}

install { ${INSTALL_LIB_DIR} ${LIBPROTOBUF_C_A} }
install { ${PBC_PUBLIC_HEADERS_DESTINATION} protobuf-c.h protobuf-c.proto }
install { ${INSTALL_PKGCONFIG_DIR} libprotobuf-c.pc }
